<!--
 ~
 ~ This file is part of Hopsworks
 ~ Copyright (C) 2021, Logical Clocks AB. All rights reserved
 ~
 ~ Hopsworks is free software: you can redistribute it and/or modify it under the terms of
 ~ the GNU Affero General Public License as published by the Free Software Foundation,
 ~ either version 3 of the License, or (at your option) any later version.
 ~
 ~ Hopsworks is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 ~ without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
 ~ PURPOSE.  See the GNU Affero General Public License for more details.
 ~
 ~ You should have received a copy of the GNU Affero General Public License along with this program.
 ~ If not, see <https://www.gnu.org/licenses/>.
 ~
 -->
<div class="modal-header">
  <button class="close" ng-click="jobAlertCtrl.close()" data-dismiss="modal" aria-hidden="true" type="button">&times;
  </button>
  <h2 class="modal-title">Alerts</h2>
</div>
<div class="modal-body" style="overflow: auto">
  <form name="jobAlertForm" role="form" ng-submit="jobAlertCtrl.createServiceAlert()">
    <div class="row" style="padding-bottom: 20px">
      <div class="col-sm-3">
        <label class="control-label">Status</label>
        <select class="form-control has-feedback" id="sel2" ng-model="jobAlertCtrl.newAlert.status"
                required>
          <option value="">--Select status--</option>
          <option ng-repeat="status in jobAlertCtrl.values.status">{{status}}</option>
        </select>
      </div>
      <div class="col-sm-3">
        <label class="control-label">Severity</label>
        <select class="form-control has-feedback" id="sel3" ng-model="jobAlertCtrl.newAlert.severity"
                required>
          <option value="">--Select severity--</option>
          <option ng-repeat="severity in jobAlertCtrl.values.severity">{{severity}}</option>
        </select>
      </div>
      <div class="col-sm-3">
        <label class="control-label">Receiver</label>
        <select class="form-control has-feedback" id="sel5" ng-model="jobAlertCtrl.newAlert.receiver"
                required>
          <option value="">--Select receiver--</option>
          <option ng-repeat="receiver in jobAlertCtrl.receivers">{{receiver.name}}</option>
        </select>
      </div>
      <div class="col-sm-3">
        <label class="control-label">Action</label>
        <button class="form-control btn btn-success" uib-tooltip="Create"
                type="submit">
          <i class="fa fa-plus"></i> Create new
        </button>
      </div>
    </div>
  </form>
    <div class="loader loader-sm" ng-show="jobAlertCtrl.loadingServiceAlerts" style="position: unset"></div>
    <div ng-show="jobAlertCtrl.serviceAlerts.length < 1"> No alert to show.</div>
    <div ng-show="jobAlertCtrl.serviceAlerts.length > 0">
      <table class="table table-bordered table-striped">
        <thead>
        <tr>
          <th>Status</th>
          <th>Severity</th>
          <th>Type</th>
          <th>Receiver</th>
          <th>Created on</th>
          <th class="text-center">Action</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-repeat="serviceAlert in jobAlertCtrl.serviceAlerts">
          <td>{{ serviceAlert.status }}</td>
          <td>{{ serviceAlert.severity }}</td>
          <td>{{ serviceAlert.alertType }}</td>
          <td>{{ serviceAlert.receiver }}</td>
          <td>{{ serviceAlert.created | date:'medium'}}</td>
          <td class="text-center">
            <button class="btn btn-danger" uib-tooltip="Delete"
                    ng-click="jobAlertCtrl.deleteServiceAlert(serviceAlert)">
              <i class="fa fa-trash"></i>
            </button>
            <button class="btn btn-success" uib-tooltip="Test"
                    ng-click="jobAlertCtrl.testServiceAlert(serviceAlert)">
              <i class="fa fa-paper-plane"></i>
            </button>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
</div>
